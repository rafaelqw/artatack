"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const database_1 = require("./database");
const record_1 = require("./record");
const model_1 = require("./model");
const misc_1 = require("./misc");
class Context {
    constructor() {
        this.aliasMap = {};
        this.counter = 0;
    }
    getAlias(builder) {
        const model = builder.model;
        const field = builder.field;
        const names = [];
        while (builder.parent) {
            names.unshift(builder.field.name);
            builder = builder.parent;
        }
        const alias = 't' + this.counter++;
        if (field instanceof model_1.ForeignKeyField) {
            this.aliasMap[names.join('.')] = { name: alias, model: model };
        }
        return alias;
    }
}
exports.Context = Context;
class QueryBuilder {
    // (model, dialect), or (parent, field)
    constructor(model, dialect) {
        this.fieldMap = {};
        if (model instanceof model_1.Model) {
            this.model = model;
            this.dialect = dialect;
            this.context = new Context();
        }
        else {
            this.parent = model;
            this.field = dialect;
            this.dialect = this.parent.dialect;
            this.context = this.parent.context;
            if (dialect instanceof model_1.ForeignKeyField) {
                this.model = dialect.referencedField.model;
            }
            else if (dialect instanceof model_1.RelatedField) {
                this.model = dialect.referencingField.model;
            }
            this.alias = this.context.getAlias(this);
        }
    }
    getFroms() {
        let builder = this;
        while (builder && builder.field instanceof model_1.ForeignKeyField) {
            builder = builder.parent;
        }
        return builder.froms;
    }
    where(args) {
        if (!args)
            return '';
        args = plainify(args);
        if (Array.isArray(args)) {
            return this.or(args);
        }
        else {
            return this.and(args);
        }
    }
    or(args) {
        const exprs = args.map(arg => this.and(arg));
        return exprs.length === 0
            ? ''
            : exprs.length === 1
                ? exprs[0]
                : exprs.map(x => `(${x})`).join(' or ');
    }
    and(args) {
        const exprs = [];
        for (const key in args) {
            const [name, operator] = splitKey(key);
            const field = this.model.field(name);
            const value = args[key];
            if (field instanceof model_1.ForeignKeyField) {
                const query = value;
                if (query === null || typeof query !== 'object') {
                    exprs.push(this.expr(field, '=', value));
                }
                else if (Array.isArray(query)) {
                    const values = [];
                    const filter = [];
                    for (const arg of query) {
                        if (arg === null || typeof arg !== 'object') {
                            values.push(arg);
                        }
                        else {
                            filter.push(arg);
                        }
                    }
                    let expr = values.length > 0 ? this.expr(field, 'in', values) : '';
                    if (filter.length > 0) {
                        if (expr.length > 0)
                            expr += ' or ';
                        expr += this._join(field, filter);
                    }
                    if (expr.length > 0) {
                        exprs.push(`${expr}`);
                    }
                }
                else {
                    const keys = Object.keys(query);
                    if (keys.length === 1) {
                        const [name, operator] = splitKey(keys[0]);
                        if (name === field.referencedField.name) {
                            const value = query[keys[0]];
                            if (database_1.isValue(value)) {
                                exprs.push(this.expr(field, operator, value));
                                continue;
                            }
                        }
                    }
                    const expr = this._join(field, query);
                    if (expr.length > 0) {
                        exprs.push(`${expr}`);
                    }
                }
            }
            else if (field instanceof model_1.SimpleField) {
                exprs.push(this.expr(field, operator, value));
            }
            else if (field instanceof model_1.RelatedField) {
                const filter = value === '*' ? {} : value;
                exprs.push(this.exists(field, operator, filter));
            }
            else if (key === exports.AND) {
                // { and: [{name_like: "%Apple%"}, {price_lt: 6}] }
                exprs.push(value.map(c => this.and(c)).join(' and '));
            }
            else if (key === exports.OR) {
                /*
                 { or: [
                        { name_like: "%Apple%" },
                        { productCategories_some:
                          { category: { name: 'Banana' } }
                        }
                      ]
                 }
                 */
                exprs.push(value.map(c => this.and(c)).join(' or '));
            }
            else if (key === exports.NOT) {
                /*
                 { not: [
                        { name_like: "%Apple%" },
                        { productCategories_some:
                          { category: { name: 'Banana' } }
                        }
                      ]
                 }
                 */
                const filters = misc_1.toArray(value);
                exprs.push('not (' + filters.map(c => this.and(c)).join(' or ') + ')');
            }
            else {
                throw Error(`Bad field: ${this.model.name}.${name}`);
            }
        }
        return exprs.length === 0
            ? ''
            : exprs.length === 1
                ? exprs[0]
                : exprs.map(x => `(${x})`).join(' and ');
    }
    expr(field, operator, value) {
        const lhs = this.encodeField(field.column.name);
        if (Array.isArray(value)) {
            if (!operator || operator === 'in') {
                const values = value
                    .filter(value => value !== null)
                    .map(value => this.escape(field, value));
                if (values.length < value.length) {
                    return `(${lhs} is null or ${lhs} in (${values.join(', ')}))`;
                }
                else {
                    if (values.length === 0)
                        return 'false';
                    return `${lhs} in (${values.join(', ')})`;
                }
            }
            else {
                throw Error(`Bad value: ${JSON.stringify(value)}`);
            }
        }
        operator = operator || '=';
        if (operator === '=' && value === null) {
            return `${lhs} is null`;
        }
        if (operator === 'null') {
            return value ? `${lhs} is null` : `${lhs} is not null`;
        }
        return `${lhs} ${operator} ${this.escape(field, value)}`;
    }
    _extendFilter(filter, orderBy) {
        for (const entry of misc_1.toArray(orderBy)) {
            const fields = entry.split('.');
            let result = filter;
            let model = this.model;
            for (let i = 0; i < fields.length - 1; i++) {
                const name = fields[i];
                if (!result[name]) {
                    result[name] = {};
                }
                const field = model.field(name);
                if (!(field instanceof model_1.ForeignKeyField)) {
                    throw Error(`Not a foreign key: ${entry}`);
                }
                result = result[name];
                model = field.referencedField.model;
            }
        }
        return filter;
    }
    _pushField(fields, path) {
        const aliasMap = this.context.aliasMap;
        let alias, field;
        const match = /^(.+)\.([^\.]+)/.exec(path);
        if (match) {
            const entry = aliasMap[match[1]];
            alias = entry.name;
            field = entry.model.field(match[2]);
        }
        else {
            alias = this.alias || this.model.table.name;
            field = this.model.field(path);
        }
        if (field instanceof model_1.SimpleField) {
            const column = `${this.escapeId(alias)}.${this.escapeId(field)}`;
            if (match) {
                const name = this.escapeId(path.replace(/\./g, '__'));
                fields.push(`${column} as ${name}`);
            }
            else {
                fields.push(`${column}`);
            }
            return column;
        }
        throw new Error(`Invalid field: ${path}`);
    }
    _select(name, filter = {}, orderBy) {
        this.froms = [`${this.escapeId(this.model)} ${this.alias || ''}`];
        if (!(name instanceof model_1.Field || typeof name === 'string')) {
            // { code: 'ID', user: { firstName: 'name' } }
            extendFilter(this.model, filter, name);
        }
        if (orderBy) {
            // orderBy: ['user.email desc']
            filter = this._extendFilter(filter, orderBy);
        }
        const where = this.where(filter).trim();
        let fields = [];
        if (name instanceof model_1.Field || typeof name === 'string') {
            fields.push(this.encodeField(name));
        }
        else if (Array.isArray(name)) {
            name.forEach(name => fields.push(this.encodeField(this.model.field(name))));
        }
        else {
            const names = getFields(this.model, name, this.fieldMap);
            for (const key of names) {
                this._pushField(fields, key);
            }
        }
        if (orderBy) {
            orderBy = misc_1.toArray(orderBy).map(order => {
                const [path, direction] = order.split(' ');
                const column = this._pushField(fields, path);
                return `${column} ${/^desc$/i.test(direction || '') ? 'DESC' : 'ASC'}`;
            });
        }
        return {
            fields: fields.join(', '),
            tables: this.froms.join(' left join '),
            where,
            orderBy: orderBy ? orderBy.join(', ') : null
        };
    }
    select(name, filter, orderBy, filterThunk) {
        const query = this._select(name, filter, orderBy);
        let sql = `select ${query.fields} from ${query.tables}`;
        if (query.where) {
            sql += ` where ${query.where}`;
        }
        if (filterThunk) {
            const extra = filterThunk(this);
            if (extra) {
                if (!query.where) {
                    sql += ' where ';
                }
                else {
                    sql += ' and ';
                }
                sql += extra;
            }
        }
        if (query.orderBy) {
            sql += ` order by ${query.orderBy}`;
        }
        return sql;
    }
    column() {
        return this.encodeField(this.model.keyField().column.name);
    }
    encodeField(name) {
        if (name instanceof model_1.SimpleField) {
            name = name.column.name;
        }
        if (/count\(\*\)/i.test(name)) {
            return name;
        }
        else if (name !== '*') {
            name = this.escapeId(name);
        }
        const alias = this.alias || this.escapeId(this.model.table.name);
        return `${alias}.${name}`;
    }
    _join(field, args) {
        if (!this.getFroms())
            return this._in(field, args);
        const builder = new QueryBuilder(this, field);
        const model = field.referencedField.model;
        const keys = Object.keys(args);
        if (keys.length === 1 && keys[0] === model.keyField().name) {
            if (database_1.isValue(args[keys[0]])) {
                return this.expr(field, null, args[keys[0]]);
            }
        }
        const name = `${this.escapeId(model.table.name)} ${builder.alias}`;
        const lhs = this.encodeField(field);
        const rhs = builder.encodeField(model.keyField());
        this.getFroms().push(`${name} on ${lhs}=${rhs}`);
        return builder.where(args);
    }
    _in(field, args) {
        const builder = new QueryBuilder(this, field);
        const model = field.referencedField.model;
        const keys = Object.keys(args);
        if (keys.length === 1 && keys[0] === model.keyField().name) {
            return this.expr(field, null, args[keys[0]]);
        }
        const lhs = this.encodeField(field.column.name);
        const rhs = builder.select(model.keyField().column.name, args);
        return `${lhs} in (${rhs})`;
    }
    exists(field, operator, args) {
        const builder = new QueryBuilder(this, field);
        const where = field.throughField
            ? builder._in(field.throughField, args)
            : builder.where(args);
        const scope = builder.select('*') +
            ' where ' +
            builder.encodeField(field.referencingField.column.name) +
            '=' +
            this.encodeField(this.model.keyField().name);
        const exists = operator === 'none' ? 'not exists' : 'exists';
        return where.length > 0
            ? `${exists} (${scope} and ${where})`
            : `${exists} (${scope})`;
    }
    escape(field, value) {
        if (/^bool/i.test(field.column.type)) {
            return value ? 'true' : 'false';
        }
        if (/int|float|double|number/i.test(field.column.type)) {
            if (typeof value === 'number') {
                return value + '';
            }
        }
        return this.dialect.escape(database_1.toRow(value, field) + '');
    }
    escapeId(name) {
        if (name instanceof model_1.SimpleField) {
            name = name.column.name;
        }
        else if (name instanceof model_1.Model) {
            name = name.table.name;
        }
        return this.dialect.escapeId(name);
    }
}
exports.QueryBuilder = QueryBuilder;
function encodeFilter(args, model, escape) {
    const builder = new QueryBuilder(model, escape);
    return builder.where(args);
}
exports.encodeFilter = encodeFilter;
exports.AND = 'and';
exports.OR = 'or';
exports.NOT = 'not';
exports.LT = 'lt';
exports.LE = 'le';
exports.GE = 'ge';
exports.GT = 'gt';
exports.NE = 'ne';
exports.IN = 'in';
exports.LIKE = 'like';
exports.NULL = 'null';
exports.SOME = 'some';
exports.NONE = 'none';
const OPERATOR_MAP = {
    [exports.LT]: '<',
    [exports.LE]: '<=',
    [exports.GE]: '>=',
    [exports.GT]: '>',
    [exports.NE]: '<>',
    [exports.IN]: 'in',
    [exports.LIKE]: 'like'
};
function splitKey(arg) {
    const match = /^(.+?)_([^_]+)$/.exec(arg);
    if (match) {
        const op = match[2] in OPERATOR_MAP ? OPERATOR_MAP[match[2]] : match[2];
        return [match[1], op];
    }
    return [arg];
}
exports.splitKey = splitKey;
function plainify(value) {
    if (Array.isArray(value)) {
        return value.map(entry => plainify(entry));
    }
    else if (database_1.isValue(value)) {
        return value;
    }
    else if (value instanceof record_1.Record) {
        const model = value.__table.model;
        if (value.__primaryKey()) {
            return { [model.keyField().name]: value.__primaryKey() };
        }
        else {
            return model.getUniqueFields(value.__data);
        }
    }
    else {
        const result = {};
        for (const key in value) {
            result[key] = plainify(value[key]);
        }
        return result;
    }
}
// Extends the filter to include foreign key fields
function extendFilter(model, filter, fields) {
    for (const name in fields) {
        const value = fields[name] === '*' ? {} : fields[name];
        if (value && typeof value === 'object') {
            const field = model.field(name);
            if (field instanceof model_1.ForeignKeyField) {
                if (!filter[name]) {
                    filter[name] = {};
                }
                extendFilter(field.referencedField.model, filter[name], value);
            }
        }
    }
}
function getFields(model, input, fieldMap, prefix) {
    let result = [];
    const getKey = (name) => (prefix ? `${prefix}.${name}` : name);
    // By default, all fields in a model are included in the query result
    for (const field of model.fields) {
        if (field instanceof model_1.SimpleField) {
            result.push(getKey(field.name));
        }
    }
    if (typeof input === 'string') {
        if (input === '*')
            return result;
    }
    for (const name in input) {
        const key = getKey(name);
        const value = input[name];
        if (!value) {
            const index = result.indexOf(key);
            if (index > -1) {
                result.splice(index, 1);
            }
        }
        else {
            const field = model.field(name);
            if (field instanceof model_1.ForeignKeyField) {
                const model = field.referencedField.model;
                const fields = getFields(model, value, fieldMap, key);
                result = result.concat(result, fields);
            }
            else if (typeof value === 'string') {
                fieldMap[key.replace(/\./g, '__')] = value;
            }
        }
    }
    return result;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2ZpbHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlDQUF1RTtBQUN2RSxxQ0FBa0M7QUFFbEMsbUNBTWlCO0FBR2pCLGlDQUFpQztBQWNqQztJQUtFO1FBRkEsYUFBUSxHQUFrQyxFQUFFLENBQUM7UUFHM0MsSUFBSSxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUVELFFBQVEsQ0FBQyxPQUFxQjtRQUM1QixNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO1FBQzVCLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFDNUIsTUFBTSxLQUFLLEdBQWEsRUFBRSxDQUFDO1FBQzNCLE9BQU8sT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUNyQixLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7U0FDMUI7UUFDRCxNQUFNLEtBQUssR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ25DLElBQUksS0FBSyxZQUFZLHVCQUFlLEVBQUU7WUFDcEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsQ0FBQztTQUNoRTtRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztDQUNGO0FBdkJELDBCQXVCQztBQUVEO0lBcUJFLHVDQUF1QztJQUN2QyxZQUFZLEtBQTJCLEVBQUUsT0FBd0I7UUFYakUsYUFBUSxHQUFHLEVBQUUsQ0FBQztRQVlaLElBQUksS0FBSyxZQUFZLGFBQUssRUFBRTtZQUMxQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FB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